# RMPE Dataset Server

This server generates augmented samples for the project [keras_Realtime_Multi-Person_Pose_Estimation](https://github.com/michalfaber/keras_Realtime_Multi-Person_Pose_Estimation)
Source samples are retrieved from the hdf5 dataset file and processed in realtime using random cropping, rotations, flipping and scaling.

## Prerequisites

- [OpenCV](https://github.com/opencv/opencv/releases/tag/3.3.0)
- [Boost](http://www.boost.org)
- [Hdf5](https://support.hdfgroup.org/HDF5/release/obtain5.html)
- [libzmq](https://github.com/zeromq/libzmq)
- [cppzmq](http://zeromq.org/bindings:cpp)

## Building

```
  mkdir build
  cd build
  cmake ..
  make
```

## Usage

Usage:
```
./rmpe_dataset_server [DATASET] [PORT]
```

DATASET - path to the hdf5 dataset generated by the tool [`generate_hdf5.py`](https://github.com/michalfaber/keras_Realtime_Multi-Person_Pose_Estimation/blob/master/training/generate_hdf5.py)

PORT - port number where augmented data are emitted.

Basically, you need to start a separate server for training dataset and validation dataset.
The procedure of training looks something like:

1. Start training data server in the first terminal session
`./rmpe_dataset_server ../../keras_Realtime_Multi-Person_Pose_Estimation/dataset/train_dataset.h5 5555`
2. Start validation data server in a second terminal session
`./rmpe_dataset_server ../../keras_Realtime_Multi-Person_Pose_Estimation/dataset/val_dataset.h5 5556`
3. Train the model in a third terminal
`python train_pose.py`

## Troubleshooting

If you see the error
```
CMake Error at CMakeLists.txt:7 (find_package):
  By not providing "FindOpenCV.cmake" in CMAKE_MODULE_PATH
```

then export the path to your OpenCV location (ex. export OpenCV_DIR=/usr/local/Cellar/opencv/3.3.0_3/share/OpenCV)